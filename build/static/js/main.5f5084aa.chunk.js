(this["webpackJsonptviitteri-frontend"]=this["webpackJsonptviitteri-frontend"]||[]).push([[0],{120:function(e,t,r){"use strict";r.r(t);var a=r(1),n=r(0),s=r(22),c=r.n(s),i=r(29),o=r(12),u=r(37),l=r(82),j=r(83),d=r(6),b=r.n(d),p=r(8),x=r(11),h=r(18),O=r.n(h),v="".concat("","/api/login"),f={login:function(){var e=Object(p.a)(b.a.mark((function e(t){var r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.a.post(v,t);case 2:return r=e.sent,e.abrupt("return",r.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},m="".concat("","/api/tviits"),w={getAll:function(){var e=Object(p.a)(b.a.mark((function e(){var t,r,a=arguments;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.length>0&&void 0!==a[0]?a[0]:0,e.next=3,O.a.get("".concat(m,"?offset=").concat(t));case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),postTviit:function(){var e=Object(p.a)(b.a.mark((function e(t,r){var a,n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={headers:{Authorization:"bearer ".concat(r)}},e.next=3,O.a.post(m,t,a);case 3:return n=e.sent,e.abrupt("return",n.data);case 5:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),deleteTviit:function(){var e=Object(p.a)(b.a.mark((function e(t,r){var a,n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={headers:{Authorization:"bearer ".concat(r)}},e.next=3,O.a.delete("".concat(m,"/").concat(t),a);case 3:return n=e.sent,e.abrupt("return",n.data);case 5:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()},g=function(e){return function(){var t=Object(p.a)(b.a.mark((function t(r){return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r({type:"SET_ACTIVE_USER",data:Object(x.a)({},e)});case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},y=function(e){return function(){var t=Object(p.a)(b.a.mark((function t(r){return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r({type:"USER_DELETE_TVIIT",data:{tviitId:e}});case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},k=function(e){return function(){var t=Object(p.a)(b.a.mark((function t(r){return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r({type:"USER_LIKE_TVIIT",data:{tviitId:e}});case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},N=function(e){return function(){var t=Object(p.a)(b.a.mark((function t(r){return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r({type:"USER_UNLIKE_TVIIT",data:{tviitId:e}});case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},S=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"USER_LOGIN":case"SET_ACTIVE_USER":return Object(x.a)({},t.data);case"USER_DELETE_TVIIT":return Object(x.a)(Object(x.a)({},e),{},{tviitDeleted:t.data.tviitId});case"USER_LIKE_TVIIT":var r=e.actions.likes.concat(t.data.tviitId);return Object(x.a)(Object(x.a)({},e),{},{actions:{likes:r}});case"USER_UNLIKE_TVIIT":var a=e.actions.likes.filter((function(e){return e!==t.data.tviitId}));return Object(x.a)(Object(x.a)({},e),{},{actions:{likes:a}});default:return e}},I=Object(u.combineReducers)({activeUser:S}),C=Object(u.createStore)(I,Object(j.composeWithDevTools)(Object(u.applyMiddleware)(l.a))),T=r(14),U=r(138),E=r(140),L=r(135),R=r(137),A=r(86),D=r(84),P=r(129),z=r(134),K=r(47),G=r(133),_="".concat("","/api/actions"),B={getAll:function(){var e=Object(p.a)(b.a.mark((function e(t){var r,a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={headers:{Authorization:"bearer ".concat(t)}},e.next=3,O.a.get(_,r);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),postAction:function(){var e=Object(p.a)(b.a.mark((function e(t,r){var a,n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={headers:{Authorization:"bearer ".concat(r)}},e.next=3,O.a.post(_,t,a);case 3:return n=e.sent,e.abrupt("return",n.data);case 5:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),deleteAction:function(){var e=Object(p.a)(b.a.mark((function e(t,r){var a,n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={data:t,headers:{Authorization:"bearer ".concat(r)}},e.next=3,O.a.delete(_,a);case 3:return n=e.sent,e.abrupt("return",n.data);case 5:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()},F=r(87),V=r(15),H=r(131),q=r(132),J=r(141),M=r(130),W=r(85),Q=r(136),Y=r(125),X=function(e){var t=e.tviitId,r=Object(o.b)(),s=Object(o.c)((function(e){return e.activeUser})),c=Object(n.useState)(!1),i=Object(V.a)(c,2),u=i[0],l=i[1],j=function(){return l(!1)},d=function(){var e=Object(p.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,w.deleteTviit(t,s.token);case 3:r(y(t)),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.log("Tviit deletion failed!");case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(){return e.apply(this,arguments)}}();return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(D.a,{variant:"primary",onClick:function(){return l(!0)},children:Object(a.jsx)(Y.a,{})}),Object(a.jsxs)(Q.a,{show:u,onHide:j,children:[Object(a.jsx)(Q.a.Header,{closeButton:!0,children:Object(a.jsx)(Q.a.Title,{children:"Delete tviit?"})}),Object(a.jsx)(Q.a.Body,{children:"Are you sure you want to delete this tviit?"}),Object(a.jsxs)(Q.a.Footer,{children:[Object(a.jsx)(D.a,{variant:"secondary",onClick:j,children:"Cancel"}),Object(a.jsx)(D.a,{variant:"primary",onClick:d,children:"Delete"})]})]})]})},Z=r(126),$=r(127),ee=function(e){var t=e.tviitId,r=e.likes,n=Object(o.b)(),s=Object(o.c)((function(e){return e.activeUser})),c=function(){var e=Object(p.a)(b.a.mark((function e(){var r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r={actionType:"like",targetTviitId:t},e.next=4,B.postAction(r,s.token);case 4:n(k(t)),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log("Tviit liking failed!");case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),i=function(){var e=Object(p.a)(b.a.mark((function e(){var r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r={actionType:"like",targetTviitId:t},e.next=4,B.deleteAction(r,s.token);case 4:n(N(t)),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log("Tviit unliking failed!");case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),u={marginTop:"3px"};return s.token?s.actions.likes.includes(t)?Object(a.jsx)(D.a,{variant:"primary",onClick:i,children:Object(a.jsxs)("div",{className:"d-flex justify-content-center",children:[Object(a.jsx)(Z.a,{className:"mr-1",style:u})," ",r]})}):Object(a.jsx)(D.a,{variant:"primary",onClick:c,children:Object(a.jsxs)("div",{className:"d-flex justify-content-center",children:[Object(a.jsx)($.a,{className:"mr-1",style:u}),r]})}):Object(a.jsx)(D.a,{variant:"primary",disabled:!0,children:Object(a.jsxs)("div",{className:"d-flex justify-content-center",children:[Object(a.jsx)(Z.a,{className:"mr-1",style:u})," ",r]})})},te=r(128),re=function(e){var t=e.userId,r=e.size,n="".concat("","/api/images/avatars/").concat(t);return Object(a.jsx)(te.a,{src:n,width:r,height:r,roundedCircle:!0})},ae=function(e){var t=e.tviit,r=Object(o.c)((function(e){return e.activeUser}));return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsxs)(J.a,{children:[Object(a.jsx)(J.a.Header,{children:Object(a.jsxs)("div",{className:"d-flex justify-content-between",children:[Object(a.jsx)(P.a,{fluid:!0,children:Object(a.jsxs)(M.a,{className:"d-flex align-items-center",children:[Object(a.jsx)(W.a,{xs:"auto",className:"pl-0 pr-2",children:Object(a.jsx)(re,{userId:t.userId,size:48})}),Object(a.jsxs)(W.a,{children:[Object(a.jsx)(M.a,{children:Object(a.jsx)("strong",{children:t.name})}),Object(a.jsx)(M.a,{children:Object(a.jsx)(K.LinkContainer,{to:"/u/".concat(t.username),children:Object(a.jsxs)(J.a.Link,{children:["@",t.username]})})})]})]})}),Object(a.jsxs)("div",{className:"d-flex align-items-center",children:[t.username!==r.username&&Object(a.jsx)(ee,{tviitId:t.id,likes:t.likes}),t.username===r.username&&Object(a.jsx)(X,{tviitId:t.id})]})]})}),Object(a.jsx)(J.a.Body,{children:Object(a.jsx)(J.a.Text,{children:t.content})}),Object(a.jsx)(J.a.Footer,{children:Object(a.jsxs)("small",{className:"text-muted",children:["Posted ",new Date(t.postDate).toString()]})})]}),Object(a.jsx)("br",{})]})},ne=function(){var e=Object(o.c)((function(e){return e.activeUser})),t=Object(n.useState)(null),r=Object(V.a)(t,2),s=r[0],c=r[1],i=Object(n.useState)(!1),u=Object(V.a)(i,2),l=u[0],j=u[1],d=Object(n.useState)(!1),x=Object(V.a)(d,2),h=x[0],O=x[1];Object(n.useEffect)((function(){(function(){var e=Object(p.a)(b.a.mark((function e(){var t,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,w.getAll();case 3:t=e.sent,c(t),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),r=e.t0.response?e.t0.response.status:null,c({error:!0,statusCode:r});case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}})()()}),[]);var v=function(){var e=Object(p.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,O(!0),e.next=4,w.getAll(s.length);case 4:0===(t=e.sent).length?j(!0):c(Object(F.a)(new Set(s.concat(t))).sort((function(e,t){return t.id-e.id}))),O(!1),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),O(!1);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}();if(!s)return Object(a.jsx)("div",{className:"text-center",children:Object(a.jsx)(H.a,{animation:"border",variant:"primary"})});if(s.error)return Object(a.jsxs)(q.a,{variant:"danger",children:["Error while fetching feed (StatusCode: ",s.statusCode,")"]});if(e.tviitDeleted&&s.map((function(e){return e.id})).includes(e.tviitDeleted)){var f=s.filter((function(t){return t.id!==e.tviitDeleted}));c(f)}return Object(a.jsxs)("div",{children:[Object(a.jsx)("h2",{children:"Newest:"}),s.map((function(e){return Object(a.jsx)(ae,{tviit:e},e.id)})),Object(a.jsxs)("div",{className:"d-flex justify-content-center",children:[!l&&!h&&Object(a.jsx)(D.a,{variant:"primary",onClick:v,className:"w-50",children:"Get more tviits"}),!l&&h&&Object(a.jsxs)(D.a,{variant:"primary",className:"w-50",disabled:!0,block:!0,children:[Object(a.jsx)(H.a,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true"}),Object(a.jsx)("span",{className:"sr-only",children:"Loading..."})]}),l&&!h&&Object(a.jsx)(D.a,{variant:"primary",className:"w-50",disabled:!0,block:!0,children:"Get more tviits"})]})]})},se="".concat("","/api/users"),ce={getUser:function(){var e=Object(p.a)(b.a.mark((function e(t){var r,a,n=arguments;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.length>1&&void 0!==n[1]?n[1]:0,e.next=3,O.a.get("".concat(se,"?username=").concat(t,"&getTviits=true&offset=").concat(r));case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),signUp:function(){var e=Object(p.a)(b.a.mark((function e(t){var r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.a.post(se,t);case 2:return r=e.sent,e.abrupt("return",r.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),modifyUserInfo:function(){var e=Object(p.a)(b.a.mark((function e(t,r,a){var n,s;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:"bearer ".concat(a)}},e.next=3,O.a.patch("".concat(se,"/").concat(r),t,n);case 3:return s=e.sent,e.abrupt("return",s.data);case 5:case"end":return e.stop()}}),e)})));return function(t,r,a){return e.apply(this,arguments)}}()},ie=function(){var e=Object(T.m)().username,t=Object(o.c)((function(e){return e.activeUser})),r=Object(n.useState)(null),s=Object(V.a)(r,2),c=s[0],i=s[1],u=Object(n.useState)(null),l=Object(V.a)(u,2),j=l[0],d=l[1];if(Object(n.useEffect)((function(){(function(){var t=Object(p.a)(b.a.mark((function t(){var r,a;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,ce.getUser(e);case 3:r=t.sent,i(Object(x.a)({},r)),t.next=11;break;case 7:t.prev=7,t.t0=t.catch(0),a=t.t0.response?t.t0.response.status:null,i({error:!0,statusCode:a});case 11:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(){return t.apply(this,arguments)}})()()}),[e]),!c)return Object(a.jsx)("div",{className:"text-center",children:Object(a.jsx)(H.a,{animation:"border",variant:"primary"})});if(c.error)return 404===c.statusCode?Object(a.jsx)(q.a,{variant:"warning",children:"404, User not found"}):Object(a.jsx)(q.a,{variant:"danger",children:"Error"});if(t.username===e&&t.tviitDeleted&&c.tviits.map((function(e){return e.id})).includes(t.tviitDeleted)){var h=c.tviits.filter((function(e){return e.id!==t.tviitDeleted}));i(Object(x.a)(Object(x.a)({},c),{},{tviits:h}))}var O=function(){var e=Object(p.a)(b.a.mark((function e(r){var a,n,s,o,u,l,j,p;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.preventDefault(),a=r.target.elements.tviitingTextArea.value,r.target.elements.tviitingTextArea.value="",n={content:a},!(a.length>0)){e.next=21;break}return e.prev=5,e.next=8,w.postTviit(n,t.token);case 8:s=e.sent,o=Object(x.a)(Object(x.a)({},s),{},{username:t.username,name:t.name}),u=Object(x.a)(Object(x.a)({},c),{},{tviits:[o].concat(c.tviits)}),i(u),d(null),e.next=21;break;case 15:e.prev=15,e.t0=e.catch(5),l=e.t0.response,j=l?l.data.error:null,p=l?l.status:null,d({error:!0,statusCode:p,errorReason:j});case 21:case"end":return e.stop()}}),e,null,[[5,15]])})));return function(t){return e.apply(this,arguments)}}();return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(P.a,{fluid:!0,children:Object(a.jsxs)(M.a,{className:"d-flex align-items-center justify-content-between",children:[Object(a.jsx)(W.a,{}),Object(a.jsx)(W.a,{xs:"auto",children:Object(a.jsxs)(M.a,{children:[Object(a.jsx)(W.a,{xs:"auto",className:"pl-0 pr-2",children:Object(a.jsx)(re,{userId:c.userId,size:72})}),Object(a.jsxs)(W.a,{xs:"auto",children:[Object(a.jsx)(M.a,{children:Object(a.jsx)("strong",{children:Object(a.jsx)("h4",{children:c.name})})}),Object(a.jsx)(M.a,{children:Object(a.jsx)("strong",{children:Object(a.jsxs)("h4",{children:["@",c.username]})})})]})]})}),Object(a.jsx)(W.a,{})]})}),Object(a.jsx)(P.a,{fluid:!0,children:Object(a.jsx)(M.a,{children:Object(a.jsx)(W.a,{className:"d-flex justify-content-center",children:Object(a.jsx)("strong",{children:Object(a.jsx)("h4",{children:Object(a.jsx)("small",{className:"text-muted",children:c.bio})})})})})}),t.username===e&&Object(a.jsxs)("div",{children:[Object(a.jsx)("hr",{}),Object(a.jsxs)(R.a,{onSubmit:O,children:[Object(a.jsxs)(R.a.Group,{controlId:"tviitingTextArea",children:[Object(a.jsx)(R.a.Label,{children:"Tviit"}),Object(a.jsx)(R.a.Control,{as:"textarea",rows:3})]}),Object(a.jsx)(D.a,{variant:"primary",type:"submit",children:"Post"})]})]}),j&&Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("br",{}),Object(a.jsxs)(q.a,{variant:"danger",children:["Error while posting tviit, ErrorReason: ",j.errorReason," (StatusCode: ",j.statusCode,")"]})]}),Object(a.jsx)("hr",{}),Object(a.jsx)("div",{children:Object(a.jsx)("div",{children:c.tviits.map((function(e){return Object(a.jsx)(ae,{tviit:e},e.id)}))})})]})},oe=function(){var e=Object(o.b)(),t=Object(o.c)((function(e){return e.activeUser})),r=Object(n.useState)(!1),s=Object(V.a)(r,2),c=s[0],i=s[1],u=Object(n.useState)(!1),l=Object(V.a)(u,2),j=l[0],d=l[1],h=function(){var t=Object(p.a)(b.a.mark((function t(r){var a,n,s,c,o;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r.preventDefault(),i(!0),a=r.target.elements.formUsername.value,n=r.target.elements.formPassword.value,r.target.elements.formUsername.value="",r.target.elements.formPassword.value="",t.prev=6,s={username:a,password:n},t.next=10,f.login(s);case 10:return c=t.sent,window.localStorage.setItem("loggedTviitteriUser",JSON.stringify(c)),t.next=14,B.getAll(c.token);case 14:o=t.sent,e(g(Object(x.a)(Object(x.a)({},c),o))),t.next=22;break;case 18:t.prev=18,t.t0=t.catch(6),i(!1),d(!0);case 22:case"end":return t.stop()}}),t,null,[[6,18]])})));return function(e){return t.apply(this,arguments)}}();return t.token?Object(a.jsx)(T.c,{to:"/"}):Object(a.jsx)(P.a,{children:Object(a.jsxs)(M.a,{className:"justify-content-md-center",children:[Object(a.jsx)(W.a,{}),Object(a.jsxs)(W.a,{sm:9,md:6,children:[Object(a.jsxs)(R.a,{onSubmit:h,children:[Object(a.jsxs)(R.a.Group,{controlId:"formUsername",children:[Object(a.jsx)(R.a.Label,{children:"Username"}),Object(a.jsx)(R.a.Control,{type:"text",placeholder:"Username"})]}),Object(a.jsxs)(R.a.Group,{controlId:"formPassword",children:[Object(a.jsx)(R.a.Label,{children:"Password"}),Object(a.jsx)(R.a.Control,{type:"password",placeholder:"Password"})]}),Object(a.jsxs)("div",{className:"d-flex justify-content-center",children:[!c&&Object(a.jsx)(D.a,{variant:"primary",type:"submit",children:"Submit"}),c&&Object(a.jsxs)(D.a,{variant:"primary",disabled:!0,children:[Object(a.jsx)(H.a,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true"}),Object(a.jsx)("span",{className:"sr-only",children:"Loading..."})]})]})]}),Object(a.jsx)("br",{}),j&&Object(a.jsx)(q.a,{variant:"danger",children:"Wrong username or password!"})]}),Object(a.jsx)(W.a,{})]})})},ue="".concat("","/api/search"),le={getSearchResults:function(){var e=Object(p.a)(b.a.mark((function e(t){var r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.a.get("".concat(ue,"?q=").concat(encodeURIComponent(t)));case 2:return r=e.sent,e.abrupt("return",r.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},je=function(){var e=new URLSearchParams(Object(T.l)().search).get("q"),t=Object(n.useState)(null),r=Object(V.a)(t,2),s=r[0],c=r[1];return Object(n.useEffect)((function(){(function(){var t=Object(p.a)(b.a.mark((function t(){var r,a,n,s;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,le.getSearchResults(e);case 3:r=t.sent,c(r),t.next=13;break;case 7:t.prev=7,t.t0=t.catch(0),a=t.t0.response,n=a.data?a.data.error:null,s=a?a.status:null,c({error:!0,statusCode:s,errorReason:n});case 13:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(){return t.apply(this,arguments)}})()()}),[e]),s?s.error?Object(a.jsxs)(q.a,{variant:"danger",children:["Error while fetching search results, ErrorReason: ",s.errorReason," (StatusCode: ",s.statusCode,")"]}):0===s.length?Object(a.jsx)(q.a,{variant:"warning",children:"No results found"}):Object(a.jsxs)("div",{children:[Object(a.jsx)("h2",{children:"Search results:"}),s.map((function(e){return Object(a.jsx)(ae,{tviit:e},e.id)}))]}):Object(a.jsx)("div",{className:"text-center",children:Object(a.jsx)(H.a,{animation:"border",variant:"primary"})})},de=function(){var e=Object(o.b)(),t=Object(o.c)((function(e){return e.activeUser})),r=Object(n.useState)(!1),s=Object(V.a)(r,2),c=s[0],i=s[1],u=Object(n.useState)(null),l=Object(V.a)(u,2),j=l[0],d=l[1],x=function(){var t=Object(p.a)(b.a.mark((function t(r){var a,n,s,c,o,u,l,j,p,x,h;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r.preventDefault(),i(!0),a=r.target.elements.formUsername.value,n=r.target.elements.formName.value,s=r.target.elements.formPassword.value,c=r.target.elements.formPasswordVerify.value,s===c){t.next=11;break}d({error:!0,statusCode:400,errorReason:"password fields don't match"}),i(!1),t.next=31;break;case 11:return t.prev=11,o={username:a,name:n,password:s},t.next=15,ce.signUp(o);case 15:return u=t.sent,l={username:u.username,password:s},t.next=19,f.login(l);case 19:j=t.sent,window.localStorage.setItem("loggedTviitteriUser",JSON.stringify(j)),e(g(j)),t.next=31;break;case 24:t.prev=24,t.t0=t.catch(11),p=t.t0.response,x=p?p.data.error:null,h=p?p.status:null,d({error:!0,statusCode:h,errorReason:x}),i(!1);case 31:case"end":return t.stop()}}),t,null,[[11,24]])})));return function(e){return t.apply(this,arguments)}}();return t.token?Object(a.jsx)(T.c,{to:"/u/".concat(t.username)}):Object(a.jsx)(P.a,{children:Object(a.jsxs)(M.a,{children:[Object(a.jsx)(W.a,{}),Object(a.jsxs)(W.a,{sm:9,md:6,children:[Object(a.jsxs)(R.a,{onSubmit:x,children:[Object(a.jsxs)(R.a.Group,{controlId:"formUsername",children:[Object(a.jsx)(R.a.Label,{children:"Username"}),Object(a.jsx)(R.a.Control,{type:"text",placeholder:"Username"})]}),Object(a.jsxs)(R.a.Group,{controlId:"formName",children:[Object(a.jsx)(R.a.Label,{children:"Name"}),Object(a.jsx)(R.a.Control,{type:"text",placeholder:"Name"})]}),Object(a.jsxs)(R.a.Group,{controlId:"formPassword",children:[Object(a.jsx)(R.a.Label,{children:"Password"}),Object(a.jsx)(R.a.Control,{type:"password",placeholder:"Password"})]}),Object(a.jsxs)(R.a.Group,{controlId:"formPasswordVerify",children:[Object(a.jsx)(R.a.Label,{children:"Password again"}),Object(a.jsx)(R.a.Control,{type:"password",placeholder:"Password"})]}),Object(a.jsxs)("div",{className:"d-flex justify-content-center",children:[!c&&Object(a.jsx)(D.a,{variant:"primary",type:"submit",children:"Submit"}),c&&Object(a.jsxs)(D.a,{variant:"primary",disabled:!0,children:[Object(a.jsx)(H.a,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true"}),Object(a.jsx)("span",{className:"sr-only",children:"Loading..."})]})]})]}),Object(a.jsx)("br",{}),j&&Object(a.jsxs)(q.a,{variant:"danger",children:["Error while signing up, ErrorReason: ",j.errorReason," (StatusCode: ",j.statusCode,")"]})]}),Object(a.jsx)(W.a,{})]})})},be=r(139),pe="".concat("","/api/upload"),xe={postAvatar:function(){var e=Object(p.a)(b.a.mark((function e(t,r){var a,n,s;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(a=new FormData).append("avatar",t),n={headers:{"Content-Type":"multipart/form-data",Authorization:"bearer ".concat(r)}},e.next=5,O.a.post("".concat(pe,"/avatar"),a,n);case 5:return s=e.sent,e.abrupt("return",s.data);case 7:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()},he=function(){var e=Object(o.c)((function(e){return e.activeUser})),t=Object(n.useState)(!1),r=Object(V.a)(t,2),s=r[0],c=r[1],i=Object(n.useState)(null),u=Object(V.a)(i,2),l=u[0],j=u[1],d=Object(n.useState)([]),x=Object(V.a)(d,2),h=x[0],O=x[1],v=function(){var t=Object(p.a)(b.a.mark((function t(r){var a,n,s,i,o,u,l;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r.preventDefault(),c(!0),a=r.target.elements.formOldPassword.value,n=r.target.elements.formNewPassword.value,s=r.target.elements.formNewPasswordVerify.value,r.target.elements.formOldPassword.value="",r.target.elements.formNewPassword.value="",r.target.elements.formNewPasswordVerify.value="",n!==s){t.next=26;break}return t.prev=9,i={oldPassword:a,newPassword:n},t.next=13,ce.modifyUserInfo(i,e.userId,e.token);case 13:j(null),c(!1),t.next=24;break;case 17:t.prev=17,t.t0=t.catch(9),o=t.t0.response,u=o?o.data.error:null,l=o?o.status:null,j({error:!0,statusCode:l,errorReason:u}),c(!1);case 24:t.next=30;break;case 26:"new password fields are not equal",400,j({error:!0,statusCode:400,errorReason:"new password fields are not equal"}),c(!1);case 30:case"end":return t.stop()}}),t,null,[[9,17]])})));return function(e){return t.apply(this,arguments)}}(),f=function(){var t=Object(p.a)(b.a.mark((function t(r){var a,n,s,i,o;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r.preventDefault(),c(!0),a=r.target.elements.formNewName.value,r.target.elements.formNewName.value="",t.prev=4,n={name:a},t.next=8,ce.modifyUserInfo(n,e.userId,e.token);case 8:j(null),c(!1),t.next=19;break;case 12:t.prev=12,t.t0=t.catch(4),s=t.t0.response,i=s?s.data.error:null,o=s?s.status:null,j({error:!0,statusCode:o,errorReason:i}),c(!1);case 19:case"end":return t.stop()}}),t,null,[[4,12]])})));return function(e){return t.apply(this,arguments)}}(),m=function(){var t=Object(p.a)(b.a.mark((function t(r){var a,n,s,i,o;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r.preventDefault(),c(!0),a=r.target.elements.formNewBio.value,r.target.elements.formNewBio.value="",t.prev=4,n={bio:a},t.next=8,ce.modifyUserInfo(n,e.userId,e.token);case 8:j(null),c(!1),t.next=19;break;case 12:t.prev=12,t.t0=t.catch(4),s=t.t0.response,i=s?s.data.error:null,o=s?s.status:null,j({error:!0,statusCode:o,errorReason:i}),c(!1);case 19:case"end":return t.stop()}}),t,null,[[4,12]])})));return function(e){return t.apply(this,arguments)}}(),w=function(){var t=Object(p.a)(b.a.mark((function t(r){var a,n,s,i;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r.preventDefault(),c(!0),a=h[0],t.prev=3,t.next=6,xe.postAvatar(a,e.token);case 6:j(null),c(!1),t.next=17;break;case 10:t.prev=10,t.t0=t.catch(3),n=t.t0.response,s=n?n.data.error:null,i=n?n.status:null,j({error:!0,statusCode:i,errorReason:s}),c(!1);case 17:case"end":return t.stop()}}),t,null,[[3,10]])})));return function(e){return t.apply(this,arguments)}}();return e.token?Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("h2",{children:"Settings"}),l&&Object(a.jsxs)(a.Fragment,{children:[Object(a.jsxs)(q.a,{variant:"danger",children:["ErrorReason: ",l.errorReason," (StatusCode: ",l.statusCode,")"]}),Object(a.jsx)("br",{})]}),Object(a.jsxs)(be.a,{defaultActiveKey:"0",children:[Object(a.jsxs)(J.a,{children:[Object(a.jsx)(J.a.Header,{children:Object(a.jsx)(be.a.Toggle,{as:D.a,variant:"link",eventKey:"0",children:"Change name"})}),Object(a.jsx)(be.a.Collapse,{eventKey:"0",children:Object(a.jsx)(J.a.Body,{children:Object(a.jsxs)(R.a,{onSubmit:f,children:[Object(a.jsxs)(R.a.Group,{controlId:"formNewName",children:[Object(a.jsx)(R.a.Label,{children:"New name"}),Object(a.jsx)(R.a.Control,{type:"text",placeholder:"New name"})]}),Object(a.jsxs)("div",{className:"d-flex justify-content-center",children:[!s&&Object(a.jsx)(D.a,{variant:"primary",type:"submit",children:"Submit"}),s&&Object(a.jsxs)(D.a,{variant:"primary",disabled:!0,children:[Object(a.jsx)(H.a,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true"}),Object(a.jsx)("span",{className:"sr-only",children:"Loading..."})]})]})]})})})]}),Object(a.jsxs)(J.a,{children:[Object(a.jsx)(J.a.Header,{children:Object(a.jsx)(be.a.Toggle,{as:D.a,variant:"link",eventKey:"1",children:"Change bio"})}),Object(a.jsx)(be.a.Collapse,{eventKey:"1",children:Object(a.jsx)(J.a.Body,{children:Object(a.jsxs)(R.a,{onSubmit:m,children:[Object(a.jsxs)(R.a.Group,{controlId:"formNewBio",children:[Object(a.jsx)(R.a.Label,{children:"New bio"}),Object(a.jsx)(R.a.Control,{type:"text",placeholder:"New bio"})]}),Object(a.jsxs)("div",{className:"d-flex justify-content-center",children:[!s&&Object(a.jsx)(D.a,{variant:"primary",type:"submit",children:"Submit"}),s&&Object(a.jsxs)(D.a,{variant:"primary",disabled:!0,children:[Object(a.jsx)(H.a,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true"}),Object(a.jsx)("span",{className:"sr-only",children:"Loading..."})]})]})]})})})]}),Object(a.jsxs)(J.a,{children:[Object(a.jsx)(J.a.Header,{children:Object(a.jsx)(be.a.Toggle,{as:D.a,variant:"link",eventKey:"2",children:"Change password"})}),Object(a.jsx)(be.a.Collapse,{eventKey:"2",children:Object(a.jsx)(J.a.Body,{children:Object(a.jsxs)(R.a,{onSubmit:v,children:[Object(a.jsxs)(R.a.Group,{controlId:"formOldPassword",children:[Object(a.jsx)(R.a.Label,{children:"Current password"}),Object(a.jsx)(R.a.Control,{type:"password",placeholder:"Current password"})]}),Object(a.jsxs)(R.a.Group,{controlId:"formNewPassword",children:[Object(a.jsx)(R.a.Label,{children:"New password"}),Object(a.jsx)(R.a.Control,{type:"password",placeholder:"New password"})]}),Object(a.jsxs)(R.a.Group,{controlId:"formNewPasswordVerify",children:[Object(a.jsx)(R.a.Label,{children:"New password again"}),Object(a.jsx)(R.a.Control,{type:"password",placeholder:"New password again"})]}),Object(a.jsxs)("div",{className:"d-flex justify-content-center",children:[!s&&Object(a.jsx)(D.a,{variant:"primary",type:"submit",children:"Submit"}),s&&Object(a.jsxs)(D.a,{variant:"primary",disabled:!0,children:[Object(a.jsx)(H.a,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true"}),Object(a.jsx)("span",{className:"sr-only",children:"Loading..."})]})]})]})})})]}),Object(a.jsxs)(J.a,{children:[Object(a.jsx)(J.a.Header,{children:Object(a.jsx)(be.a.Toggle,{as:D.a,variant:"link",eventKey:"3",children:"Change avatar"})}),Object(a.jsx)(be.a.Collapse,{eventKey:"3",children:Object(a.jsx)(J.a.Body,{children:Object(a.jsxs)(R.a,{encType:"multipart/form-data",onSubmit:w,children:[Object(a.jsx)(R.a.Group,{controlId:"formNewAvatar",children:Object(a.jsx)(R.a.File,{id:"avatar",label:"New avatar",onChange:function(e){O(e.target.files)}})}),Object(a.jsxs)("div",{className:"d-flex justify-content-center",children:[!s&&Object(a.jsx)(D.a,{variant:"primary",type:"submit",children:"Submit"}),s&&Object(a.jsxs)(D.a,{variant:"primary",disabled:!0,children:[Object(a.jsx)(H.a,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true"}),Object(a.jsx)("span",{className:"sr-only",children:"Loading..."})]})]})]})})})]})]})]}):Object(a.jsx)(T.c,{to:"/"})},Oe=function(){return Object(a.jsx)("div",{children:Object(a.jsx)("h1",{children:"404 - Not Found!"})})},ve=Object(T.o)((function(){var e=Object(o.b)(),t=Object(o.c)((function(e){return e.activeUser})),r=Object(T.k)();Object(n.useEffect)((function(){(function(){var t=Object(p.a)(b.a.mark((function t(){var r,a,n;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(r=window.localStorage.getItem("loggedTviitteriUser"))){t.next=7;break}return a=JSON.parse(r),t.next=5,B.getAll(a.token);case 5:n=t.sent,e(g(Object(x.a)(Object(x.a)({},a),n)));case 7:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}})()()}),[e]);var s=function(a){"login"===a?r.push("/login"):"sign-up"===a?r.push("/sign-up"):"my-page"===a?r.push("/u/".concat(t.username)):"settings"===a?r.push("/settings"):"logout"===a&&(e(g({})),window.localStorage.clear(),r.push("/"))};return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsxs)(U.a,{collapseOnSelect:!0,expand:"md",bg:"primary",variant:"dark",children:[Object(a.jsx)(K.LinkContainer,{to:"/",children:Object(a.jsx)(G.a,{className:"align-top",size:40,color:"#f8f9fa"})}),Object(a.jsx)(U.a.Toggle,{"aria-controls":"responsive-navbar-nav"}),Object(a.jsxs)(U.a.Collapse,{id:"responsive-navbar-nav",children:[Object(a.jsx)(E.a,{className:"mr-auto",children:Object(a.jsx)(K.LinkContainer,{to:"/",children:Object(a.jsx)(E.a.Link,{href:"#",children:"Home"})})}),Object(a.jsxs)(E.a,{children:[!t.token&&Object(a.jsxs)(L.a,{onSelect:s,title:"Login / Sign up",id:"basic-nav-dropdown",children:[Object(a.jsx)(L.a.Item,{eventKey:"login",children:"Login"}),Object(a.jsx)(L.a.Divider,{}),Object(a.jsx)(L.a.Item,{eventKey:"sign-up",children:"Sign up"})]}),t.token&&Object(a.jsxs)(L.a,{onSelect:s,title:"@".concat(t.username),id:"basic-nav-dropdown",children:[Object(a.jsx)(L.a.Item,{eventKey:"my-page",children:"My page"}),Object(a.jsx)(L.a.Divider,{}),Object(a.jsx)(L.a.Item,{eventKey:"settings",children:"Settings"}),Object(a.jsx)(L.a.Divider,{}),Object(a.jsx)(L.a.Item,{eventKey:"logout",children:"Logout"})]})]}),Object(a.jsx)(R.a,{inline:!0,onSubmit:function(e){e.preventDefault();var t=e.target.elements.formNavBarSearch.value;e.target.elements.formNavBarSearch.value="",""!==t&&r.push("/search?q=".concat(encodeURIComponent(t)))},children:Object(a.jsxs)(R.a.Group,{controlId:"formNavBarSearch",children:[Object(a.jsx)(A.a,{type:"text",placeholder:"Search",className:"mr-sm-2"}),Object(a.jsx)(D.a,{variant:"outline-light",type:"submit",children:"Search"})]})})]})]}),Object(a.jsxs)(P.a,{children:[Object(a.jsx)("br",{}),Object(a.jsxs)(T.g,{children:[Object(a.jsx)(T.d,{path:"/login",children:Object(a.jsx)(oe,{})}),Object(a.jsx)(T.d,{path:"/sign-up",children:Object(a.jsx)(de,{})}),Object(a.jsx)(T.d,{path:"/u/:username",children:Object(a.jsx)(ie,{})}),Object(a.jsx)(T.d,{path:"/settings",children:Object(a.jsx)(he,{})}),Object(a.jsx)(T.d,{path:"/search",children:Object(a.jsx)(je,{})}),Object(a.jsxs)(T.d,{exact:!0,path:"/",children:[Object(a.jsxs)(z.a,{children:[Object(a.jsx)("h1",{children:"Hello and welcome to Tviitteri!"}),Object(a.jsx)("p",{children:"Tviitteri is a simple microblog service built with React.js, Node.js, Express.js and it uses a SQLite database."})]}),Object(a.jsx)("hr",{}),Object(a.jsx)(ne,{})]}),Object(a.jsx)(T.d,{component:Oe})]}),Object(a.jsx)("hr",{}),Object(a.jsx)("div",{className:"text-center",children:Object(a.jsxs)("i",{children:["Tviitteri, ",(new Date).getFullYear()]})})]})]})}));c.a.render(Object(a.jsx)(o.a,{store:C,children:Object(a.jsx)(i.BrowserRouter,{children:Object(a.jsx)(ve,{})})}),document.getElementById("root"))}},[[120,1,2]]]);
//# sourceMappingURL=main.5f5084aa.chunk.js.map
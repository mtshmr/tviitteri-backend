(this["webpackJsonptviitteri-frontend"]=this["webpackJsonptviitteri-frontend"]||[]).push([[0],{119:function(e,t,r){"use strict";r.r(t);var n=r(1),a=r(0),s=r(22),c=r.n(s),i=r(28),o=r(12),l=r(37),u=r(82),j=r(83),d=r(6),b=r.n(d),p=r(8),x=r(11),O=r(18),h=r.n(O),f={login:function(){var e=Object(p.a)(b.a.mark((function e(t){var r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.a.post("/api/login",t);case 2:return r=e.sent,e.abrupt("return",r.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},v="/api/tviits",m={getAll:function(){var e=Object(p.a)(b.a.mark((function e(){var t,r,n=arguments;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:0,e.next=3,h.a.get("".concat(v,"?offset=").concat(t));case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),postTviit:function(){var e=Object(p.a)(b.a.mark((function e(t,r){var n,a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:"bearer ".concat(r)}},e.next=3,h.a.post(v,t,n);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),deleteTviit:function(){var e=Object(p.a)(b.a.mark((function e(t,r){var n,a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:"bearer ".concat(r)}},e.next=3,h.a.delete("".concat(v,"/").concat(t),n);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()},w=function(e){return function(){var t=Object(p.a)(b.a.mark((function t(r){return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r({type:"SET_ACTIVE_USER",data:Object(x.a)({},e)});case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},g=function(e){return function(){var t=Object(p.a)(b.a.mark((function t(r){return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r({type:"USER_DELETE_TVIIT",data:{tviitId:e}});case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},y=function(e){return function(){var t=Object(p.a)(b.a.mark((function t(r){return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r({type:"USER_LIKE_TVIIT",data:{tviitId:e}});case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},k=function(e){return function(){var t=Object(p.a)(b.a.mark((function t(r){return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r({type:"USER_UNLIKE_TVIIT",data:{tviitId:e}});case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},N=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"USER_LOGIN":case"SET_ACTIVE_USER":return Object(x.a)({},t.data);case"USER_DELETE_TVIIT":return Object(x.a)(Object(x.a)({},e),{},{tviitDeleted:t.data.tviitId});case"USER_LIKE_TVIIT":var r=e.actions.likes.concat(t.data.tviitId);return Object(x.a)(Object(x.a)({},e),{},{actions:{likes:r}});case"USER_UNLIKE_TVIIT":var n=e.actions.likes.filter((function(e){return e!==t.data.tviitId}));return Object(x.a)(Object(x.a)({},e),{},{actions:{likes:n}});default:return e}},S=Object(l.combineReducers)({activeUser:N}),I=Object(l.createStore)(S,Object(j.composeWithDevTools)(Object(l.applyMiddleware)(u.a))),C=r(14),T=r(137),U=r(139),E=r(134),L=r(136),R=r(86),P=r(84),D=r(127),A=r(133),_=r(47),G=r(132),K="/api/actions",z={getAll:function(){var e=Object(p.a)(b.a.mark((function e(t){var r,n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={headers:{Authorization:"bearer ".concat(t)}},e.next=3,h.a.get(K,r);case 3:return n=e.sent,e.abrupt("return",n.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),postAction:function(){var e=Object(p.a)(b.a.mark((function e(t,r){var n,a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:"bearer ".concat(r)}},e.next=3,h.a.post(K,t,n);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),deleteAction:function(){var e=Object(p.a)(b.a.mark((function e(t,r){var n,a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={data:t,headers:{Authorization:"bearer ".concat(r)}},e.next=3,h.a.delete(K,n);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()},B=r(87),V=r(16),F=r(130),H=r(131),q=r(140),J=r(128),M=r(85),W=r(129),Q=r(135),Y=r(124),X=function(e){var t=e.tviitId,r=Object(o.b)(),s=Object(o.c)((function(e){return e.activeUser})),c=Object(a.useState)(!1),i=Object(V.a)(c,2),l=i[0],u=i[1],j=function(){return u(!1)},d=function(){var e=Object(p.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,m.deleteTviit(t,s.token);case 3:r(g(t)),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.log("Tviit deletion failed!");case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(){return e.apply(this,arguments)}}();return Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)(P.a,{variant:"primary",onClick:function(){return u(!0)},children:Object(n.jsx)(Y.a,{})}),Object(n.jsxs)(Q.a,{show:l,onHide:j,children:[Object(n.jsx)(Q.a.Header,{closeButton:!0,children:Object(n.jsx)(Q.a.Title,{children:"Delete tviit?"})}),Object(n.jsx)(Q.a.Body,{children:"Are you sure you want to delete this tviit?"}),Object(n.jsxs)(Q.a.Footer,{children:[Object(n.jsx)(P.a,{variant:"secondary",onClick:j,children:"Cancel"}),Object(n.jsx)(P.a,{variant:"primary",onClick:d,children:"Delete"})]})]})]})},Z=r(125),$=r(126),ee=function(e){var t=e.tviitId,r=e.likes,a=Object(o.b)(),s=Object(o.c)((function(e){return e.activeUser})),c=function(){var e=Object(p.a)(b.a.mark((function e(){var r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r={actionType:"like",targetTviitId:t},e.next=4,z.postAction(r,s.token);case 4:a(y(t)),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log("Tviit liking failed!");case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),i=function(){var e=Object(p.a)(b.a.mark((function e(){var r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r={actionType:"like",targetTviitId:t},e.next=4,z.deleteAction(r,s.token);case 4:a(k(t)),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log("Tviit unliking failed!");case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),l={marginTop:"3px"};return s.token?s.actions.likes.includes(t)?Object(n.jsx)(P.a,{variant:"primary",onClick:i,children:Object(n.jsxs)("div",{className:"d-flex justify-content-center",children:[Object(n.jsx)(Z.a,{className:"mr-1",style:l})," ",r]})}):Object(n.jsx)(P.a,{variant:"primary",onClick:c,children:Object(n.jsxs)("div",{className:"d-flex justify-content-center",children:[Object(n.jsx)($.a,{className:"mr-1",style:l}),r]})}):Object(n.jsx)(P.a,{variant:"primary",disabled:!0,children:Object(n.jsxs)("div",{className:"d-flex justify-content-center",children:[Object(n.jsx)(Z.a,{className:"mr-1",style:l})," ",r]})})},te=function(e){var t=e.tviit,r=Object(o.c)((function(e){return e.activeUser}));return Object(n.jsxs)(n.Fragment,{children:[Object(n.jsxs)(q.a,{children:[Object(n.jsx)(q.a.Header,{children:Object(n.jsxs)("div",{className:"d-flex justify-content-between",children:[Object(n.jsx)(D.a,{fluid:!0,children:Object(n.jsxs)(J.a,{className:"d-flex align-items-center",children:[Object(n.jsx)(M.a,{xs:"auto",className:"pl-0 pr-2",children:Object(n.jsx)(W.a,{size:48,color:"#007bff"})}),Object(n.jsxs)(M.a,{children:[Object(n.jsx)(J.a,{children:Object(n.jsx)("strong",{children:t.name})}),Object(n.jsx)(J.a,{children:Object(n.jsx)(_.LinkContainer,{to:"/u/".concat(t.username),children:Object(n.jsxs)(q.a.Link,{children:["@",t.username]})})})]})]})}),Object(n.jsxs)("div",{className:"d-flex align-items-center",children:[t.username!==r.username&&Object(n.jsx)(ee,{tviitId:t.id,likes:t.likes}),t.username===r.username&&Object(n.jsx)(X,{tviitId:t.id})]})]})}),Object(n.jsx)(q.a.Body,{children:Object(n.jsx)(q.a.Text,{children:t.content})}),Object(n.jsx)(q.a.Footer,{children:Object(n.jsxs)("small",{className:"text-muted",children:["Posted ",new Date(t.postDate).toString()]})})]}),Object(n.jsx)("br",{})]})},re=function(){var e=Object(o.c)((function(e){return e.activeUser})),t=Object(a.useState)(null),r=Object(V.a)(t,2),s=r[0],c=r[1],i=Object(a.useState)(!1),l=Object(V.a)(i,2),u=l[0],j=l[1],d=Object(a.useState)(!1),x=Object(V.a)(d,2),O=x[0],h=x[1];Object(a.useEffect)((function(){(function(){var e=Object(p.a)(b.a.mark((function e(){var t,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,m.getAll();case 3:t=e.sent,c(t),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),r=e.t0.response?e.t0.response.status:null,c({error:!0,statusCode:r});case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}})()()}),[]);var f=function(){var e=Object(p.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,h(!0),e.next=4,m.getAll(s.length);case 4:0===(t=e.sent).length?j(!0):c(Object(B.a)(new Set(s.concat(t))).sort((function(e,t){return t.id-e.id}))),h(!1),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),h(!1);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}();if(!s)return Object(n.jsx)("div",{className:"text-center",children:Object(n.jsx)(F.a,{animation:"border",variant:"primary"})});if(s.error)return Object(n.jsxs)(H.a,{variant:"danger",children:["Error while fetching feed (StatusCode: ",s.statusCode,")"]});if(e.tviitDeleted&&s.map((function(e){return e.id})).includes(e.tviitDeleted)){var v=s.filter((function(t){return t.id!==e.tviitDeleted}));c(v)}return Object(n.jsxs)("div",{children:[Object(n.jsx)("h2",{children:"Newest:"}),s.map((function(e){return Object(n.jsx)(te,{tviit:e},e.id)})),Object(n.jsxs)("div",{className:"d-flex justify-content-center",children:[!u&&!O&&Object(n.jsx)(P.a,{variant:"primary",onClick:f,className:"w-50",children:"Get more tviits"}),!u&&O&&Object(n.jsxs)(P.a,{variant:"primary",className:"w-50",disabled:!0,block:!0,children:[Object(n.jsx)(F.a,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true"}),Object(n.jsx)("span",{className:"sr-only",children:"Loading..."})]}),u&&!O&&Object(n.jsx)(P.a,{variant:"primary",className:"w-50",disabled:!0,block:!0,children:"Get more tviits"})]})]})},ne="/api/users",ae={getUser:function(){var e=Object(p.a)(b.a.mark((function e(t){var r,n,a=arguments;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.length>1&&void 0!==a[1]?a[1]:0,e.next=3,h.a.get("".concat(ne,"?username=").concat(t,"&getTviits=true&offset=").concat(r));case 3:return n=e.sent,e.abrupt("return",n.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),signUp:function(){var e=Object(p.a)(b.a.mark((function e(t){var r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.a.post(ne,t);case 2:return r=e.sent,e.abrupt("return",r.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),modifyUserInfo:function(){var e=Object(p.a)(b.a.mark((function e(t,r,n){var a,s;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={headers:{Authorization:"bearer ".concat(n)}},e.next=3,h.a.patch("".concat(ne,"/").concat(r),t,a);case 3:return s=e.sent,e.abrupt("return",s.data);case 5:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}()},se=function(){var e=Object(C.m)().username,t=Object(o.c)((function(e){return e.activeUser})),r=Object(a.useState)(null),s=Object(V.a)(r,2),c=s[0],i=s[1],l=Object(a.useState)(null),u=Object(V.a)(l,2),j=u[0],d=u[1];if(Object(a.useEffect)((function(){(function(){var t=Object(p.a)(b.a.mark((function t(){var r,n;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,ae.getUser(e);case 3:r=t.sent,i(Object(x.a)({},r)),t.next=11;break;case 7:t.prev=7,t.t0=t.catch(0),n=t.t0.response?t.t0.response.status:null,i({error:!0,statusCode:n});case 11:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(){return t.apply(this,arguments)}})()()}),[e]),!c)return Object(n.jsx)("div",{className:"text-center",children:Object(n.jsx)(F.a,{animation:"border",variant:"primary"})});if(c.error)return 404===c.statusCode?Object(n.jsx)(H.a,{variant:"warning",children:"404, User not found"}):Object(n.jsx)(H.a,{variant:"danger",children:"Error"});if(t.username===e&&t.tviitDeleted&&c.tviits.map((function(e){return e.id})).includes(t.tviitDeleted)){var O=c.tviits.filter((function(e){return e.id!==t.tviitDeleted}));i(Object(x.a)(Object(x.a)({},c),{},{tviits:O}))}var h=function(){var e=Object(p.a)(b.a.mark((function e(r){var n,a,s,o,l,u,j,p;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.preventDefault(),n=r.target.elements.tviitingTextArea.value,r.target.elements.tviitingTextArea.value="",a={content:n},!(n.length>0)){e.next=21;break}return e.prev=5,e.next=8,m.postTviit(a,t.token);case 8:s=e.sent,o=Object(x.a)(Object(x.a)({},s),{},{username:t.username,name:t.name}),l=Object(x.a)(Object(x.a)({},c),{},{tviits:[o].concat(c.tviits)}),i(l),d(null),e.next=21;break;case 15:e.prev=15,e.t0=e.catch(5),u=e.t0.response,j=u?u.data.error:null,p=u?u.status:null,d({error:!0,statusCode:p,errorReason:j});case 21:case"end":return e.stop()}}),e,null,[[5,15]])})));return function(t){return e.apply(this,arguments)}}();return Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)(D.a,{fluid:!0,children:Object(n.jsxs)(J.a,{className:"d-flex align-items-center justify-content-between",children:[Object(n.jsx)(M.a,{}),Object(n.jsx)(M.a,{xs:"auto",children:Object(n.jsxs)(J.a,{children:[Object(n.jsx)(M.a,{xs:"auto",className:"pl-0 pr-2",children:Object(n.jsx)(W.a,{size:72,color:"#007bff"})}),Object(n.jsxs)(M.a,{xs:"auto",children:[Object(n.jsx)(J.a,{children:Object(n.jsx)("strong",{children:Object(n.jsx)("h4",{children:c.name})})}),Object(n.jsx)(J.a,{children:Object(n.jsx)("strong",{children:Object(n.jsxs)("h4",{children:["@",c.username]})})})]})]})}),Object(n.jsx)(M.a,{})]})}),Object(n.jsx)(D.a,{fluid:!0,children:Object(n.jsx)(J.a,{children:Object(n.jsx)(M.a,{className:"d-flex justify-content-center",children:Object(n.jsx)("strong",{children:Object(n.jsx)("h4",{children:Object(n.jsx)("small",{className:"text-muted",children:c.bio})})})})})}),t.username===e&&Object(n.jsxs)("div",{children:[Object(n.jsx)("hr",{}),Object(n.jsxs)(L.a,{onSubmit:h,children:[Object(n.jsxs)(L.a.Group,{controlId:"tviitingTextArea",children:[Object(n.jsx)(L.a.Label,{children:"Tviit"}),Object(n.jsx)(L.a.Control,{as:"textarea",rows:3})]}),Object(n.jsx)(P.a,{variant:"primary",type:"submit",children:"Post"})]})]}),j&&Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)("br",{}),Object(n.jsxs)(H.a,{variant:"danger",children:["Error while posting tviit, ErrorReason: ",j.errorReason," (StatusCode: ",j.statusCode,")"]})]}),Object(n.jsx)("hr",{}),Object(n.jsx)("div",{children:Object(n.jsx)("div",{children:c.tviits.map((function(e){return Object(n.jsx)(te,{tviit:e},e.id)}))})})]})},ce=function(){var e=Object(o.b)(),t=Object(o.c)((function(e){return e.activeUser})),r=Object(a.useState)(!1),s=Object(V.a)(r,2),c=s[0],i=s[1],l=Object(a.useState)(!1),u=Object(V.a)(l,2),j=u[0],d=u[1],O=function(){var t=Object(p.a)(b.a.mark((function t(r){var n,a,s,c,o;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r.preventDefault(),i(!0),n=r.target.elements.formUsername.value,a=r.target.elements.formPassword.value,r.target.elements.formUsername.value="",r.target.elements.formPassword.value="",t.prev=6,s={username:n,password:a},t.next=10,f.login(s);case 10:return c=t.sent,window.localStorage.setItem("loggedTviitteriUser",JSON.stringify(c)),t.next=14,z.getAll(c.token);case 14:o=t.sent,e(w(Object(x.a)(Object(x.a)({},c),o))),t.next=22;break;case 18:t.prev=18,t.t0=t.catch(6),i(!1),d(!0);case 22:case"end":return t.stop()}}),t,null,[[6,18]])})));return function(e){return t.apply(this,arguments)}}();return t.token?Object(n.jsx)(C.c,{to:"/"}):Object(n.jsx)(D.a,{children:Object(n.jsxs)(J.a,{className:"justify-content-md-center",children:[Object(n.jsx)(M.a,{}),Object(n.jsxs)(M.a,{sm:9,md:6,children:[Object(n.jsxs)(L.a,{onSubmit:O,children:[Object(n.jsxs)(L.a.Group,{controlId:"formUsername",children:[Object(n.jsx)(L.a.Label,{children:"Username"}),Object(n.jsx)(L.a.Control,{type:"text",placeholder:"Username"})]}),Object(n.jsxs)(L.a.Group,{controlId:"formPassword",children:[Object(n.jsx)(L.a.Label,{children:"Password"}),Object(n.jsx)(L.a.Control,{type:"password",placeholder:"Password"})]}),Object(n.jsxs)("div",{className:"d-flex justify-content-center",children:[!c&&Object(n.jsx)(P.a,{variant:"primary",type:"submit",children:"Submit"}),c&&Object(n.jsxs)(P.a,{variant:"primary",disabled:!0,children:[Object(n.jsx)(F.a,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true"}),Object(n.jsx)("span",{className:"sr-only",children:"Loading..."})]})]})]}),Object(n.jsx)("br",{}),j&&Object(n.jsx)(H.a,{variant:"danger",children:"Wrong username or password!"})]}),Object(n.jsx)(M.a,{})]})})},ie={getSearchResults:function(){var e=Object(p.a)(b.a.mark((function e(t){var r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.a.get("".concat("/api/search","?q=").concat(encodeURIComponent(t)));case 2:return r=e.sent,e.abrupt("return",r.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},oe=function(){var e=new URLSearchParams(Object(C.l)().search).get("q"),t=Object(a.useState)(null),r=Object(V.a)(t,2),s=r[0],c=r[1];return Object(a.useEffect)((function(){(function(){var t=Object(p.a)(b.a.mark((function t(){var r,n,a,s;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,ie.getSearchResults(e);case 3:r=t.sent,c(r),t.next=13;break;case 7:t.prev=7,t.t0=t.catch(0),n=t.t0.response,a=n.data?n.data.error:null,s=n?n.status:null,c({error:!0,statusCode:s,errorReason:a});case 13:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(){return t.apply(this,arguments)}})()()}),[e]),s?s.error?Object(n.jsxs)(H.a,{variant:"danger",children:["Error while fetching search results, ErrorReason: ",s.errorReason," (StatusCode: ",s.statusCode,")"]}):0===s.length?Object(n.jsx)(H.a,{variant:"warning",children:"No results found"}):Object(n.jsxs)("div",{children:[Object(n.jsx)("h2",{children:"Search results:"}),s.map((function(e){return Object(n.jsx)(te,{tviit:e},e.id)}))]}):Object(n.jsx)("div",{className:"text-center",children:Object(n.jsx)(F.a,{animation:"border",variant:"primary"})})},le=function(){var e=Object(o.b)(),t=Object(o.c)((function(e){return e.activeUser})),r=Object(a.useState)(!1),s=Object(V.a)(r,2),c=s[0],i=s[1],l=Object(a.useState)(null),u=Object(V.a)(l,2),j=u[0],d=u[1],x=function(){var t=Object(p.a)(b.a.mark((function t(r){var n,a,s,c,o,l,u,j,p,x,O;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r.preventDefault(),i(!0),n=r.target.elements.formUsername.value,a=r.target.elements.formName.value,s=r.target.elements.formPassword.value,c=r.target.elements.formPasswordVerify.value,s===c){t.next=11;break}d({error:!0,statusCode:400,errorReason:"password fields don't match"}),i(!1),t.next=31;break;case 11:return t.prev=11,o={username:n,name:a,password:s},t.next=15,ae.signUp(o);case 15:return l=t.sent,u={username:l.username,password:s},t.next=19,f.login(u);case 19:j=t.sent,window.localStorage.setItem("loggedTviitteriUser",JSON.stringify(j)),e(w(j)),t.next=31;break;case 24:t.prev=24,t.t0=t.catch(11),p=t.t0.response,x=p?p.data.error:null,O=p?p.status:null,d({error:!0,statusCode:O,errorReason:x}),i(!1);case 31:case"end":return t.stop()}}),t,null,[[11,24]])})));return function(e){return t.apply(this,arguments)}}();return t.token?Object(n.jsx)(C.c,{to:"/u/".concat(t.username)}):Object(n.jsx)(D.a,{children:Object(n.jsxs)(J.a,{children:[Object(n.jsx)(M.a,{}),Object(n.jsxs)(M.a,{sm:9,md:6,children:[Object(n.jsxs)(L.a,{onSubmit:x,children:[Object(n.jsxs)(L.a.Group,{controlId:"formUsername",children:[Object(n.jsx)(L.a.Label,{children:"Username"}),Object(n.jsx)(L.a.Control,{type:"text",placeholder:"Username"})]}),Object(n.jsxs)(L.a.Group,{controlId:"formName",children:[Object(n.jsx)(L.a.Label,{children:"Name"}),Object(n.jsx)(L.a.Control,{type:"text",placeholder:"Name"})]}),Object(n.jsxs)(L.a.Group,{controlId:"formPassword",children:[Object(n.jsx)(L.a.Label,{children:"Password"}),Object(n.jsx)(L.a.Control,{type:"password",placeholder:"Password"})]}),Object(n.jsxs)(L.a.Group,{controlId:"formPasswordVerify",children:[Object(n.jsx)(L.a.Label,{children:"Password again"}),Object(n.jsx)(L.a.Control,{type:"password",placeholder:"Password"})]}),Object(n.jsxs)("div",{className:"d-flex justify-content-center",children:[!c&&Object(n.jsx)(P.a,{variant:"primary",type:"submit",children:"Submit"}),c&&Object(n.jsxs)(P.a,{variant:"primary",disabled:!0,children:[Object(n.jsx)(F.a,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true"}),Object(n.jsx)("span",{className:"sr-only",children:"Loading..."})]})]})]}),Object(n.jsx)("br",{}),j&&Object(n.jsxs)(H.a,{variant:"danger",children:["Error while signing up, ErrorReason: ",j.errorReason," (StatusCode: ",j.statusCode,")"]})]}),Object(n.jsx)(M.a,{})]})})},ue=r(138),je=function(){var e=Object(o.c)((function(e){return e.activeUser})),t=Object(a.useState)(!1),r=Object(V.a)(t,2),s=r[0],c=r[1],i=Object(a.useState)(null),l=Object(V.a)(i,2),u=l[0],j=l[1],d=function(){var t=Object(p.a)(b.a.mark((function t(r){var n,a,s,i,o,l,u;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r.preventDefault(),c(!0),n=r.target.elements.formOldPassword.value,a=r.target.elements.formNewPassword.value,s=r.target.elements.formNewPasswordVerify.value,r.target.elements.formOldPassword.value="",r.target.elements.formNewPassword.value="",r.target.elements.formNewPasswordVerify.value="",a!==s){t.next=26;break}return t.prev=9,i={oldPassword:n,newPassword:a},t.next=13,ae.modifyUserInfo(i,e.userId,e.token);case 13:j(null),c(!1),t.next=24;break;case 17:t.prev=17,t.t0=t.catch(9),o=t.t0.response,l=o?o.data.error:null,u=o?o.status:null,j({error:!0,statusCode:u,errorReason:l}),c(!1);case 24:t.next=30;break;case 26:"new password fields are not equal",400,j({error:!0,statusCode:400,errorReason:"new password fields are not equal"}),c(!1);case 30:case"end":return t.stop()}}),t,null,[[9,17]])})));return function(e){return t.apply(this,arguments)}}(),x=function(){var t=Object(p.a)(b.a.mark((function t(r){var n,a,s,i,o;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r.preventDefault(),c(!0),n=r.target.elements.formNewName.value,r.target.elements.formNewName.value="",t.prev=4,a={name:n},t.next=8,ae.modifyUserInfo(a,e.userId,e.token);case 8:j(null),c(!1),t.next=19;break;case 12:t.prev=12,t.t0=t.catch(4),s=t.t0.response,i=s?s.data.error:null,o=s?s.status:null,j({error:!0,statusCode:o,errorReason:i}),c(!1);case 19:case"end":return t.stop()}}),t,null,[[4,12]])})));return function(e){return t.apply(this,arguments)}}(),O=function(){var t=Object(p.a)(b.a.mark((function t(r){var n,a,s,i,o;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r.preventDefault(),c(!0),n=r.target.elements.formNewBio.value,r.target.elements.formNewBio.value="",t.prev=4,a={bio:n},t.next=8,ae.modifyUserInfo(a,e.userId,e.token);case 8:j(null),c(!1),t.next=19;break;case 12:t.prev=12,t.t0=t.catch(4),s=t.t0.response,i=s?s.data.error:null,o=s?s.status:null,j({error:!0,statusCode:o,errorReason:i}),c(!1);case 19:case"end":return t.stop()}}),t,null,[[4,12]])})));return function(e){return t.apply(this,arguments)}}();return e.token?Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)("h2",{children:"Settings"}),u&&Object(n.jsxs)(n.Fragment,{children:[Object(n.jsxs)(H.a,{variant:"danger",children:["ErrorReason: ",u.errorReason," (StatusCode: ",u.statusCode,")"]}),Object(n.jsx)("br",{})]}),Object(n.jsxs)(ue.a,{defaultActiveKey:"0",children:[Object(n.jsxs)(q.a,{children:[Object(n.jsx)(q.a.Header,{children:Object(n.jsx)(ue.a.Toggle,{as:P.a,variant:"link",eventKey:"0",children:"Change name"})}),Object(n.jsx)(ue.a.Collapse,{eventKey:"0",children:Object(n.jsx)(q.a.Body,{children:Object(n.jsxs)(L.a,{onSubmit:x,children:[Object(n.jsxs)(L.a.Group,{controlId:"formNewName",children:[Object(n.jsx)(L.a.Label,{children:"New name"}),Object(n.jsx)(L.a.Control,{type:"text",placeholder:"New name"})]}),Object(n.jsxs)("div",{className:"d-flex justify-content-center",children:[!s&&Object(n.jsx)(P.a,{variant:"primary",type:"submit",children:"Submit"}),s&&Object(n.jsxs)(P.a,{variant:"primary",disabled:!0,children:[Object(n.jsx)(F.a,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true"}),Object(n.jsx)("span",{className:"sr-only",children:"Loading..."})]})]})]})})})]}),Object(n.jsxs)(q.a,{children:[Object(n.jsx)(q.a.Header,{children:Object(n.jsx)(ue.a.Toggle,{as:P.a,variant:"link",eventKey:"1",children:"Change bio"})}),Object(n.jsx)(ue.a.Collapse,{eventKey:"1",children:Object(n.jsx)(q.a.Body,{children:Object(n.jsxs)(L.a,{onSubmit:O,children:[Object(n.jsxs)(L.a.Group,{controlId:"formNewBio",children:[Object(n.jsx)(L.a.Label,{children:"New bio"}),Object(n.jsx)(L.a.Control,{type:"text",placeholder:"New bio"})]}),Object(n.jsxs)("div",{className:"d-flex justify-content-center",children:[!s&&Object(n.jsx)(P.a,{variant:"primary",type:"submit",children:"Submit"}),s&&Object(n.jsxs)(P.a,{variant:"primary",disabled:!0,children:[Object(n.jsx)(F.a,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true"}),Object(n.jsx)("span",{className:"sr-only",children:"Loading..."})]})]})]})})})]}),Object(n.jsxs)(q.a,{children:[Object(n.jsx)(q.a.Header,{children:Object(n.jsx)(ue.a.Toggle,{as:P.a,variant:"link",eventKey:"2",children:"Change password"})}),Object(n.jsx)(ue.a.Collapse,{eventKey:"2",children:Object(n.jsx)(q.a.Body,{children:Object(n.jsxs)(L.a,{onSubmit:d,children:[Object(n.jsxs)(L.a.Group,{controlId:"formOldPassword",children:[Object(n.jsx)(L.a.Label,{children:"Current password"}),Object(n.jsx)(L.a.Control,{type:"password",placeholder:"Current password"})]}),Object(n.jsxs)(L.a.Group,{controlId:"formNewPassword",children:[Object(n.jsx)(L.a.Label,{children:"New password"}),Object(n.jsx)(L.a.Control,{type:"password",placeholder:"New password"})]}),Object(n.jsxs)(L.a.Group,{controlId:"formNewPasswordVerify",children:[Object(n.jsx)(L.a.Label,{children:"New password again"}),Object(n.jsx)(L.a.Control,{type:"password",placeholder:"New password again"})]}),Object(n.jsxs)("div",{className:"d-flex justify-content-center",children:[!s&&Object(n.jsx)(P.a,{variant:"primary",type:"submit",children:"Submit"}),s&&Object(n.jsxs)(P.a,{variant:"primary",disabled:!0,children:[Object(n.jsx)(F.a,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true"}),Object(n.jsx)("span",{className:"sr-only",children:"Loading..."})]})]})]})})})]})]})]}):Object(n.jsx)(C.c,{to:"/"})},de=function(){return Object(n.jsx)("div",{children:Object(n.jsx)("h1",{children:"404 - Not Found!"})})},be=Object(C.o)((function(){var e=Object(o.b)(),t=Object(o.c)((function(e){return e.activeUser})),r=Object(C.k)();Object(a.useEffect)((function(){(function(){var t=Object(p.a)(b.a.mark((function t(){var r,n,a;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(r=window.localStorage.getItem("loggedTviitteriUser"))){t.next=7;break}return n=JSON.parse(r),t.next=5,z.getAll(n.token);case 5:a=t.sent,e(w(Object(x.a)(Object(x.a)({},n),a)));case 7:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}})()()}),[e]);var s=function(n){"login"===n?r.push("/login"):"sign-up"===n?r.push("/sign-up"):"my-page"===n?r.push("/u/".concat(t.username)):"settings"===n?r.push("/settings"):"logout"===n&&(e(w({})),window.localStorage.clear(),r.push("/"))};return Object(n.jsxs)(n.Fragment,{children:[Object(n.jsxs)(T.a,{collapseOnSelect:!0,expand:"md",bg:"primary",variant:"dark",children:[Object(n.jsx)(_.LinkContainer,{to:"/",children:Object(n.jsx)(G.a,{className:"align-top",size:40,color:"#f8f9fa"})}),Object(n.jsx)(T.a.Toggle,{"aria-controls":"responsive-navbar-nav"}),Object(n.jsxs)(T.a.Collapse,{id:"responsive-navbar-nav",children:[Object(n.jsx)(U.a,{className:"mr-auto",children:Object(n.jsx)(_.LinkContainer,{to:"/",children:Object(n.jsx)(U.a.Link,{href:"#",children:"Home"})})}),Object(n.jsxs)(U.a,{children:[!t.token&&Object(n.jsxs)(E.a,{onSelect:s,title:"Login / Sign up",id:"basic-nav-dropdown",children:[Object(n.jsx)(E.a.Item,{eventKey:"login",children:"Login"}),Object(n.jsx)(E.a.Divider,{}),Object(n.jsx)(E.a.Item,{eventKey:"sign-up",children:"Sign up"})]}),t.token&&Object(n.jsxs)(E.a,{onSelect:s,title:"@".concat(t.username),id:"basic-nav-dropdown",children:[Object(n.jsx)(E.a.Item,{eventKey:"my-page",children:"My page"}),Object(n.jsx)(E.a.Divider,{}),Object(n.jsx)(E.a.Item,{eventKey:"settings",children:"Settings"}),Object(n.jsx)(E.a.Divider,{}),Object(n.jsx)(E.a.Item,{eventKey:"logout",children:"Logout"})]})]}),Object(n.jsx)(L.a,{inline:!0,onSubmit:function(e){e.preventDefault();var t=e.target.elements.formNavBarSearch.value;e.target.elements.formNavBarSearch.value="",""!==t&&r.push("/search?q=".concat(encodeURIComponent(t)))},children:Object(n.jsxs)(L.a.Group,{controlId:"formNavBarSearch",children:[Object(n.jsx)(R.a,{type:"text",placeholder:"Search",className:"mr-sm-2"}),Object(n.jsx)(P.a,{variant:"outline-light",type:"submit",children:"Search"})]})})]})]}),Object(n.jsxs)(D.a,{children:[Object(n.jsx)("br",{}),Object(n.jsxs)(C.g,{children:[Object(n.jsx)(C.d,{path:"/login",children:Object(n.jsx)(ce,{})}),Object(n.jsx)(C.d,{path:"/sign-up",children:Object(n.jsx)(le,{})}),Object(n.jsx)(C.d,{path:"/u/:username",children:Object(n.jsx)(se,{})}),Object(n.jsx)(C.d,{path:"/settings",children:Object(n.jsx)(je,{})}),Object(n.jsx)(C.d,{path:"/search",children:Object(n.jsx)(oe,{})}),Object(n.jsxs)(C.d,{exact:!0,path:"/",children:[Object(n.jsxs)(A.a,{children:[Object(n.jsx)("h1",{children:"Hello and welcome to Tviitteri!"}),Object(n.jsx)("p",{children:"Tviitteri is a simple microblog service built with React.js, Node.js, Express.js and it uses a SQLite database."})]}),Object(n.jsx)("hr",{}),Object(n.jsx)(re,{})]}),Object(n.jsx)(C.d,{component:de})]}),Object(n.jsx)("hr",{}),Object(n.jsx)("div",{className:"text-center",children:Object(n.jsxs)("i",{children:["Tviitteri, ",(new Date).getFullYear()]})})]})]})}));c.a.render(Object(n.jsx)(o.a,{store:I,children:Object(n.jsx)(i.BrowserRouter,{children:Object(n.jsx)(be,{})})}),document.getElementById("root"))}},[[119,1,2]]]);
//# sourceMappingURL=main.35a6af47.chunk.js.map